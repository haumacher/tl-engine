<p></p>
<h1 id="Formatannotationen">Formatannotationen</h1>
<p>Für komplexe Werte eines Property, die nicht durch eine typisierte Konfiguration definiert sind, kann ein Format annotiert werden, welches den Wert aus der Konfiguration bestimmt. Dazu muss die Annotation</p>
<pre><code>@Format(MyValueProvider.class)
A getA()
</code></pre>
<p>gesetzt werden. Alternativ kann diese Annotation auch an der Klasse selbst gesetzt werden:</p>
<pre><code>@Format(MyValueProvider.class)
class A {
  ...
}
</code></pre>
<p>Hierbei ist <code class="hljs inlineCode">MyValueProvider</code> eine Implementierungsklasse von <a href="http://tl/svn/top-logic/trunk/TL/tl-doc/javadoc/index.html#com.top_logic.basic.config.ConfigurationValueProvider" title="com.top_logic.basic.config.ConfigurationValueProvider in tl" target="_blank">​ConfigurationValueProvider&lt;A&gt;</a>.</p>
<p>Es gibt viele vordefinierte Formate für Java-Standard-Typen wie z.B. für <code class="hljs inlineCode">Color</code> das Format <a href="http://tl/svn/top-logic/trunk/TL/tl-doc/javadoc/index.html#com.top_logic.reporting.flex.chart.config.color.HexEncodedPaint" title="com.top_logic.reporting.flex.chart.config.color.HexEncodedPaint in tl" target="_blank">​HexEncodedPaint</a>, oder <a href="http://tl/svn/top-logic/trunk/TL/tl-doc/javadoc/index.html#com.top_logic.basic.config.format.MillisFormat" title="com.top_logic.basic.config.format.MillisFormat in tl" target="_blank">​MillisFormat</a>, um eine Angabe "<code class="hljs inlineCode">5min 30s</code>" in einen <code class="hljs inlineCode">long</code>-Wert in Millisecunden einzulesen.</p>
<p>Eigene Formate für eigene Typen können dabei einfach als Ableitung von <a href="http://tl/svn/top-logic/trunk/TL/tl-doc/javadoc/index.html#com.top_logic.basic.config.AbstractConfigurationValueProvider" title="com.top_logic.basic.config.AbstractConfigurationValueProvider in tl" target="_blank">​AbstractConfigurationValueProvider</a> erstellt und entweder an ein konkretes Property oder an den selbstdefinierten Werte-Typ annotiert werden.</p>
<h2 id="Short-Cut-Formatfüritem-wertigeProperties">Short-Cut-Format für item-wertige Properties</h2>
<p>Es ist möglich, auch für ein Property, das eine Unterkonfiguration akzeptiert (vgl. <a href="?page=XMLBinding&amp;uuid=4269c26d-3e60-4ca8-8883-1a5afd894fed" data-custom="false" class="tlObject">XMLBinding</a>), ein Format zu definieren, um solche Unterkonfigurationen über eine Kurzschreibweise z.B. in einer eigens definierten Domain-Specific-Language (DSL) einzugeben.</p>
<p>So könnte die folgende Konfiguration über mehrere Schreibweisen eingegeben werden:</p>
<pre><code>interface MainConfig extends ConfigurationItem {
   @Format(PointConfigFormat.class)
   PointConfig getSub();
}

interface PointConfig extends ConfigurationItem {
   int getX();
   int getY();
}

class PointConfigFormat extends AbstractConfigurationValueProvider&lt;PointConfig&gt; {
   // Parse as "x, y"
}
</code></pre>
<p>Regulär als Unterkonfiguration:</p>
<pre><code>&lt;config&gt;
  &lt;sub x="13" y="42"/&gt;
&lt;/config&gt;
</code></pre>
<p>Als Kurzschreibweise im Attribut:</p>
<pre><code>&lt;config sub="13, 42"/&gt;
</code></pre>
<p>Als Kurzschreibweise im Unterelement:</p>
<pre><code>&lt;config&gt;
  &lt;sub&gt;13, 42&lt;/sub&gt;
&lt;/config&gt;
</code></pre>
<p>Insbesondere bei komplexen Ausdrücken, für die eine "echte" DSL definiert ist, eignet sich die letzt Form der Eingabe.</p>