<p>&nbsp;</p>
<h1>Volle Versionierung in der Knowledge-Base</h1>
<p>Ziel der versionierenden Knowledge-Base ist es, alle Änderungen, die an einem Top-Logic-System vorgenommen wurden, so nachvollziehbar zu machen, dass ein beliebiger Zustand in der Vergangenheit rekonstruiert werden kann. Diese Vergangenheitsinformation kann eingesetzt werden,</p>
<ul>
 <li>um Systemzustände einzufrieren, auf die später Bezug genommen werden kann (Planstände),</li>
 <li>um die Änderungshistorie einzelnder Objekte, oder des Gesamtsystems anzuzeigen (Journal).</li>
</ul>
<p>Eine zusätzliche Anforderung ist es, von einem Systemzustand einen Zweig/Branch abzuspalten, um alternative Änderungen auf denselben Objekten vornehmen zu können. Dieser Mechanismus kann eingesetzt werden,</p>
<ul>
 <li>um Releases von Datenbeständen pflegen zu können, oder</li>
 <li>um simulativ Änderungen an Datenbeständen vornehmen zu können, die keine Auswirkungen auf den "Hauptdatenbestand" hat, oder</li>
 <li>um einen persönlichen Workspace pro Benutzer realisieren zu können, in dem dieser Änderungen vornehmen kann, die nicht direkt von anderen Nutzern gesehen werden können.</li>
 <li>Evtl. kann die Technik auch dazu benutzt werden, um ein mandantenfähiges System zu realisieren.</li>
</ul>
<h2>Revisionen</h2>
<p>Jedes Commit im System erzeugt eine Revision, die über eine fortlaufende Nummer identifiziert wird. Die Revision speichert den Commit-Zeitpunkt und den Initiator des Commits.</p>
<p>See:&nbsp;<a class="tlObject" data-custom="true" href="?page=Versioning&amp;uuid=9320ab94-eb74-4ee2-ba9f-3a223e25570d">Versioning Knowledge Base</a></p>
<h2>Versionierung von Basisattributen</h2>
<p>Die Revisionsnummer wird Teil des Primärschlüssels aller (versionierbaren) Tabellen. Beim Ändern von Basisattributen eines Objekts wird eine neue Tabellenzeile angelegt, welche den geänderten Objektzustand speichert.</p>
<h2>Versionierung von dynamischen Attributen</h2>
<p>Änderung von dynamischen Attributen (von versionierten Typen <img alt="(?)" src="ref:question.png.png">) sind nicht überschreibend. Neue Werte von dynamischen Attributen werden unter der aktuell erzeugten Revisionsnummer abgelegt.</p>
<h2>Navigation in historischem Kontext</h2>
<p>Eine In-Memory-Repräsentanz eines Objektes befindet sich entweder im "aktuellen" Kontext oder in einem über eine Revisionsnummer identifizierten historischen Kontext. Nur Objekte im aktuellen Kontext können modifiziert werden. Navigation über Assoziationen behält den Kontext des Ausgangsobjektes bei. Dadurch kann dieselbe Funktionalität auf aktuelle und historische Objekte angewendet werden, ohne den Revisionskontext bei Navigation explizit mitführen zu müssen.</p>
<p>Folge: In-Memory-Repräsentanzen von historischen Objekten in unterschiedlichem Revisionskontext müssen auch dann verschiedene Objekte sein, wenn sich ihre eigenen Attribute zwischen den beiden Revisionen nicht geändert haben.</p>
<h2>Historische Assoziationen</h2>
<p>Navigation über reguläre Assoziationen behält den Revisionskontex des Ausgangsobjektes bei. Daher können mit solchen Assoziationen keine Planstände (Verweise auf explizite Versionen von Objekten) gespeichert werden. Um explizit Referenzen in den Vergangenheit von Objekten setzen zu können, werden Assoziationen benötigt, welche zusätzlich zur Zielobjekt eine Revisionsnummer speichern.</p>
<h2>Objekthistorie</h2>
<ul>
 <li>Objekt in gegebener historischer Version</li>
 <li>Alle ändernden Revisionen</li>
</ul>
<p>Vereinigung aus allen Revisionen, in denen Basisattribute, dynamische Attribute, oder Assoziationen von/zu einem Objekt geändert wurden.</p>
<ul>
 <li>Die Anfrage definiert einen Relevanzkontext, mit dem es möglich ist, die Anfrage fachlich einzuschränken.</li>
 <li>Die anlegende Revision</li>
</ul>
<p>Häufig auftretender Spezialfall von "Alle ändernden Revisionen", der das Live-Cycle-Attribut "Creator" ersetzt.</p>
<h2>Systemhistorie</h2>
<ul>
 <li>Auslesen der letzten erzeugten Revision</li>
 <li>Auslesen des Erstellungszeitpunktes einer Revision</li>
 <li>Auslesen des Initiators einer Revision</li>
 <li>Alle in einer Revision geänderten Objekte (Basisattribute, dynamische Attribute, Assoziationen)</li>
</ul>
<h2>Branches</h2>
<p>Ein Branch ist eine (optional optimiert gespeicherte) Kopie des Systems (oder eines Teils des Systems).</p>
<p>See: <a class="tlObject" data-custom="true" href="?page=Branches&amp;uuid=9f31c13b-7a63-41cd-b1b1-422e28c3de13">Knowledge Base Branch</a></p>
<h3>Navigation in Branches</h3>
<p>Branches sind vollständig voneinander getrennt. Navigation (sowohl im historischen Kontext als auch über historische Assoziationen) bewegt sich nur innerhalb eines Branches.</p>
<h3>Objekthistorie in Branches</h3>
<p>Die Historie eines Objektes endet mit Erstellung seines Branches. Im Kontext von Branches ist die anlegende Revision eines Objekts, das bereits bei Erzeugung des Branches existierte, die Revision, mit der der Branch angelegt wurde.</p>
<h3>Systemhistorie in Branches</h3>
<p>Die Systemhistorie ist branchübergreifend. Die Menge der in einer Revision geänderten Objekte kann potentiell Versionen desselben Objektes aus unterschiedlichen Branches umfassen.</p>
<h2>Branchhistorie</h2>
<p>Systemhistorie eingeschränkt auf einen Branch.</p>
<h2>Differenzbildung</h2>
<p>Differenzbildung ist eine spezielle Abfrage, welche die Änderungen liefert, die zwischen zwei Zeitpunkten auf einer gegebenen Menge von Objekten durchgeführt wurden. Das Journal ist eine Visualisierung einer Abfolge von Differenzen. Differenzbildung wird außerdem für fachliche Merge-Operationen benötigt.</p>
<h2>Merging</h2>
<p>Änderungen, die in einem Branch durchgeführt wurden, können in einen anderen Branch übernommen werden, indem eine Differenz, die im Quellbranch gebildet wurde, auf den Zielbranch angewendet wird. Die Differenzbildung ist die zentrale Abfrage, mit der fachliche Merge-Operationen (beispielsweise zwischen Releases) durchgeführt werden können.</p>
<h1>Arbeitspakete</h1>
<h2>B1: Konservative Erweiterung für Branches</h2>
<ul>
 <li>Erstellen eines Banch-Typs in der Knowledge-Base analog zu dem Revisionstyp.</li>
 <li>Erweiterung der Primärschlüssel der Knowledge-Base Basistypen Objekt und Assoziation um eine Owner-Branch-Spalte</li>
 <li>Anlegen eines Default-Branches bei Systeminitialisierung.</li>
 <li>Aufnahme des Branches in die Anfrage-Schnittstelle der Knowledge-Base.</li>
 <li>Erweiterung aller Queries um den Branch des Anfragekontextes.</li>
 <li>Management einer speziellen Assoziation "basedOn" für branchübergreifende Navigation der Objekthistorie.</li>
</ul>
<h2>B2: Anlegen von Branches (standard)</h2>
<ul>
 <li>Schnittstelle zum Anlegen eines Branches mit Basis (Ausgangsbranch, Revisionsnummer).</li>
 <li>Branch erstreckt sich auf alle branchbaren Typen.</li>
</ul>
<h2>B3: Anlegen von Branches (custom)</h2>
<ul>
 <li>Schnittstelle zum Anlegen eines Branches mit Basis Set&lt;(Objekt, Revisionsnummer)&gt;.</li>
</ul>
<h2>D1: Dynamische Attribute (Store/Fetch)</h2>
<ul>
 <li>Anbindung Data-Manager an die Revisionsnummernvergabe.</li>
 <li>Anbindung des Anfragekontexts des Data-Manger an den Versionskontext des Knowledge-Objekts</li>
</ul>
<h2>D2: Dynamische Attribute (Historie)</h2>
<ul>
 <li>Implementierung eines Anfragemoduls für MetaHistoryManager für dynamische Attribute.</li>
</ul>
<h2>H1: Historie</h2>
<ul>
 <li>Definition der Schnittstelle MetaHistoryManager für einen fachlichen Anfragekontext auf Meta-Element-Ebene</li>
 <li>Definition einer generischen Beschreibung von Objektmengen-Differenzen</li>
 <li>Implementierung von MetaHistoryManager mit Anfragemodul für Knowledge-Base-Attribute und Assoziationen.</li>
</ul>
<h2>H2: Historische Assoziationen</h2>
<ul>
 <li>Erweiterung des Assoziationstyps um einen Modifier "historic" pro Ende.</li>
 <li>Anpassung des Navigationscodes.</li>
</ul>
<h3>J1: Anzeigekomponente für Objekthistorie</h3>
<ul>
 <li>Übersetzung einer Menge von Objektdifferenzen in eine graphische Anzeige.</li>
 <li>Tabelle mit ändernden Revisionen.</li>
 <li>Detail-Ansicht mit Tabelle von Elementaränderungen.</li>
</ul>
<h3>J2: Anzeigekomponente für Systemhistorie</h3>
<ul>
 <li>Tabelle mit allen Revisionen (opt. engeschränkt auf einen Branch).</li>
 <li>Detailansicht mit Liste der geänderten Objekte (mit fachlichem Filter).</li>
 <li>Navigationsmöglichkeit zu der Objekthistorie des Einzelobjektes.</li>
</ul>
<h2>M1: Kompatibilitätsvergleicher für Differenzen</h2>
<h2>M2: Mechanismus zum Anwenden einer Differenz auf eine Menge von Zielobjekten</h2>
<h2>M3: Komponente für die interaktive Durchführung einer Merge-Operation</h2>
<ul>
 <li>Merge-Tree-Instanz?</li>
</ul>