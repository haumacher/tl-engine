<?xml version="1.0" encoding="utf-8" ?>

<config:template-call
	xmlns:config="http://www.top-logic.com/ns/config/6.0"
	final="true"
	template="com.top_logic.model.search/transaction.template.xml"
>
	<arguments
		formType="tl.contact.ui:CreateLogin"
		height="200px"
		width="400px"
	>
		<title>
			<title key="dynamic.7e7cdc47-1f79-475b-9d95-350b01f50ef8">
				<en>Create Account</en>
				<de>Neuer Zugang</de>
			</title>
		</title>
		<open-handler id="ID_1acf3ff6_1800_47fe_825f_1792b13b560d"
			config:interface="com.top_logic.layout.editor.config.DialogOpenHandlerConfig"
			group="Write"
			image="css:fas fa-user-plus"
			targetComponent="admin/persons/accounts/createAccount/dialog.layout.xml#Form"
		>
			<resourceKey key="dynamic.7e7cdc47-1f79-475b-9d95-350b01f50ef8">
				<en>Create Account</en>
				<de>Neuer Zugang</de>
			</resourceKey>
		</open-handler>
		<transactionHandler id="perform"
			class="com.top_logic.model.search.providers.TransactionHandlerByExpression"
			clique="apply"
			closeDialog="true"
			confirm="false"
			confirmMessage=""
			group="Write"
			image="theme:ICONS_BUTTON_OK"
		>
			<resourceKey key="dynamic.7e7cdc47-1f79-475b-9d95-350b01f50ef8">
				<en>Create Account</en>
				<de>Neuer Zugang</de>
			</resourceKey>
			<postCreateActions>
				<setModel target="selection(admin/persons/accounts/accountsTable.layout.xml#Table)"/>
				<setEditMode>
					<target name="admin/persons/accounts/detailsForm.layout.xml#Form"/>
				</setEditMode>
			</postCreateActions>
			<operation><![CDATA[form -> {
    login = $form.get(`tl.contact.ui:CreateLogin#login`);
    account = new(`tl.accounts:Person`);
    $account.set(`tl.accounts:Person#name`, $login);
    contact = new(`Contacts:PersonContact`);
    $contact.set(`Contacts:PersonContact#name`, $login);
    $account.set(`tl.accounts:Person#contact`, $contact);
    $contact;
}]]></operation>
		</transactionHandler>
	</arguments>
</config:template-call>